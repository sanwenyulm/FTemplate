(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b64a6de"],{"001a":function(e,t,n){},5457:function(e,t,n){"use strict";var i=n("001a"),a=n.n(i);a.a},7320:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-button",{attrs:{type:"primary"},on:{click:e.handleAddDevice}},[e._v("\n    添加设备\n  ")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.handleRefresh}},[e._v("\n    刷新\n  ")]),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:e.deviceList,border:""}},[n("el-table-column",{attrs:{align:"center",label:"设备名称",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.name)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"序列号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.snNumber)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"header-center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(1==t.row.deviceState?"在线":"离线")+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"header-center",label:"描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.description)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){return e.handleEdit(t)}}},[e._v("\n          编辑\n        ")]),e._v(" "),n("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(n){return e.handleDelete(t)}}},[e._v("\n          删除\n        ")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){return e.handleLook(t)}}},[e._v("\n          传感器\n        ")])]}}])})],1),e._v(" "),n("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getDevices}}),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogVisible,title:"edit"===e.dialogType?"编辑设备":"新建设备"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{attrs:{model:e.device,"label-width":"80px","label-position":"left"}},[n("el-form-item",{attrs:{label:"名称"}},[n("el-input",{attrs:{placeholder:"设备名称"},model:{value:e.device.name,callback:function(t){e.$set(e.device,"name",t)},expression:"device.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"设备地址"}},[n("el-input",{attrs:{placeholder:"设备地址"},model:{value:e.device.address,callback:function(t){e.$set(e.device,"address",t)},expression:"device.address"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"设备序列号"}},[n("el-input",{attrs:{placeholder:"设备序列号"},model:{value:e.device.snNumber,callback:function(t){e.$set(e.device,"snNumber",t)},expression:"device.snNumber"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"描述"}},[n("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"Role Description"},model:{value:e.device.description,callback:function(t){e.$set(e.device,"description",t)},expression:"device.description"}})],1)],1),e._v(" "),n("div",{staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("\n        "+e._s(e.$t("permission.cancel"))+"\n      ")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.confirmRole}},[e._v("\n        "+e._s(e.$t("permission.confirm"))+"\n      ")])],1)],1)],1)},a=[],r=n("cebc"),s=(n("96cf"),n("3b8d")),l=n("df7c"),c=n.n(l),o=(n("ed08"),n("b775"));function d(e,t){return Object(o["a"])({url:"/device/all",method:"get",params:{userId:e,page:t}})}function u(e){return Object(o["a"])({url:"/device/addDevice",method:"post",data:e})}function p(e){return Object(o["a"])({url:"/device/updateDevice",method:"post",data:e})}function v(e){return Object(o["a"])({url:"/device/deleteDevice",method:"get",params:{deviceId:e}})}var h={key:"",name:"",description:"",routes:[]},m={data:function(){return{total:0,listLoading:!0,listQuery:{page:0,limit:20},switchStatus:!1,device:{monitorid:1,userid:1,id:0,deviceadd:1,snNumber:"",name:"",address:"",location:"",description:"",deviceState:""},routes:[],deviceList:[],dialogVisible:!1,dialogType:"new",checkStrictly:!1,defaultProps:{children:"children",label:"title"}}},computed:{routesData:function(){return this.routes}},created:function(){this.getDevices()},methods:{handleLook:function(e){this.$router.push({path:"/guide/sensors",query:{device:e.row}})},handleRefresh:function(){this.getDevices()},getDevices:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d(1,this.listQuery.page);case 2:t=e.sent,this.listLoading=!1,this.deviceList=t;case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleAddDevice:function(){this.role=Object.assign({},h),this.dialogType="new",this.dialogVisible=!0},handleEdit:function(e){var t=this;this.dialogType="edit",this.dialogVisible=!0,this.checkStrictly=!0,this.device=e.row,this.$nextTick(function(){var e=t.generateRoutes(t.role.routes);t.$refs.tree.setCheckedNodes(t.generateArr(e)),t.checkStrictly=!1})},handleDelete:function(e){var t=this,n=e.$index,i=e.row;this.$confirm("删除此设备?","Warning",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark(function e(){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,v(i.id);case 2:a=e.sent,a?(t.deviceList.splice(n,1),t.$message({type:"success",message:"删除成功!"})):t.$message({type:"success",message:"删除失败!"});case 4:case"end":return e.stop()}},e)}))).catch(function(e){console.error(e)})},confirmRole:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,n,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t="edit"===this.dialogType,!t){e.next=8;break}return e.next=4,p(this.device);case 4:n=e.sent,n?this.$message({type:"success",message:"更新成功!"}):this.$message({type:"success",message:"更新失败!"}),e.next=13;break;case 8:return e.next=10,u(this.device);case 10:i=e.sent,this.device.id=i,this.deviceList.push(this.device);case 13:this.dialogVisible=!1;case 14:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),onlyOneShowingChild:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=null,i=e.filter(function(e){return!e.hidden});return 1===i.length?(n=i[0],n.path=c.a.resolve(t.path,n.path),n):0===i.length&&(n=Object(r["a"])({},t,{path:"",noShowingChildren:!0}),n)}}},f=m,g=(n("5457"),n("2877")),b=Object(g["a"])(f,i,a,!1,null,"d840a108",null);t["default"]=b.exports}}]);